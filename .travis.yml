language: ruby
sudo: false
services:
  - postgresql
env:
  - RAILS_VERSION=6.1.1 DATABASE_URL=postgres://postgres@localhost/jr_test
  - RAILS_VERSION=6.1.1
  - RAILS_VERSION=6.0.3.4 DATABASE_URL=postgres://postgres@localhost/jr_test
  - RAILS_VERSION=6.0.3.4
  - RAILS_VERSION=5.2.4.4 DATABASE_URL=postgres://postgres@localhost/jr_test
  - RAILS_VERSION=5.2.4.4
  - RAILS_VERSION=5.1.7
  - RAILS_VERSION=5.0.7.2
rvm:
  - 2.6.6
  - 2.7.2
  - 3.0.0
matrix:
  allow_failures:
    - env: "RAILS_VERSION=6.1.1"
    - env: "RAILS_VERSION=6.1.1 DATABASE_URL=postgres://postgres@localhost/jr_test"
    - rvm: 3.0.0
before_install:
  - gem install bundler --version 2.2.5
before_script:
  - sh -c "if [ '$DATABASE_URL' = 'postgres://postgres@localhost/jr_test' ]; then psql -c 'DROP DATABASE IF EXISTS jr_test;' -U postgres; fi"
  - sh -c "if [ '$DATABASE_URL' = 'postgres://postgres@localhost/jr_test' ]; then psql -c 'CREATE DATABASE jr_test;' -U postgres; fi"